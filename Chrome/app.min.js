function Sports(){Base.call(this),this.localData={},this.schedule_url,this.$games={},this.$games_identifier,this.$game_table,this.$game_template,this.$no_games_message='<span class="glyphicon glyphicon-bell"></span> No Games Today'}function NBA(){Sports.call(this),this.datakey="NBA_DATA",this.today,this.schedule_url="http://data.nba.com/json/cms/noseason/scoreboard/"+this.yyyymmdd()+"/games.json",this.$game_table=$("#NBA-panel #NBA_game_table"),this.$game_template=$("#NBA-schedule-template").html(),this.updateGamesID,this.rowId="#NBA_col",this.autoUpdateButtonId=this.rowId+" #autoupdate-btn"}function NFL(){Base.call(this)}function NFLnews(){Base.call(this),this.rNFLURL="https://www.reddit.com/r/nfl.json",this.importantFlairs=["Breaking News","Injury Report","Look Here!","Retirement","Serious","Roster Move","Complaints"],this.ignoreFlairs=["Rumor","Misleading"]}function Links(){Base.call(this),this.datakey="Links_data",this.loadData(this.showTopSites,this.setDefaults)}function pageHandeler(){Base.call(this),this.datakey="pageHndler_widgets",this.$myCols,this.NFL=new NFL,this.NBA=new NBA,this.Links=new Links,this.widgetKeys=["NFL","NBA","Links"]}function triggerWidget(t){var e=t.data.that,s=$(this).attr("id").split("-")[0];$(this).find("span").toggleClass("glyphicon-ok").toggleClass("glyphicon-remove");var o="#"+s+"_col";$(o).toggle(),resizeColumns(),$(this).find("span").hasClass("glyphicon-ok")?(e.data[s]=!0,s in e&&e[s].on()):(e.data[s]=!1,s in e&&e[s].off()),e.saveData()}function resizeColumns(){}function description(t,e){var s=t.target.id;return""===s&&(s=t.target.className),""===s&&(s=e),s}var Base=function(){this.initialized=!1,this.data={},this.datakey,this.domElement};Base.prototype.on=function(){0==this.initialized&&(this.initialized=!0,this.init())},Base.prototype.off=function(){console.log("off")},Base.prototype.init=function(){},Base.prototype.loadData=function(t,e){chrome.storage.local.get(this.key,function(s){s[this.datakey]?(this.data=s[this.datakey],t.call(this)):e.call(this)}.bind(this))},Base.prototype.saveData=function(t){var e={};e[this.datakey]=this.data,chrome.storage.local.set(e,function(){t&&t.call(this)}.bind(this))},Base.prototype.displayTemplate=function(t,e,s,o,a){var i=Handlebars.templates[t],n={};n[e]=s;var r=i(n);a?(o.hide(),o.html(r),o.fadeIn(500)):o.html(r)},Base.prototype.getData=function(t,e){$.getJSON(t,function(t){e.call(this,t)}.bind(this))},Sports.prototype=Object.create(Base.prototype),Sports.prototype.constructor=Sports,Sports.prototype.init=function(){this.loadLocalSchedule(),this.cacheButtonActions(),this.specificInit()},Sports.prototype.specificInit=function(){},Sports.prototype.cacheButtonActions=function(){},Sports.prototype.getJsonData=function(t,e){console.log("getting from internet."),$.getJSON(t,function(t){this.massageData.call(this,t,e)}.bind(this))},Sports.prototype.massageData=function(t,e){},Sports.prototype.getDataSchedule=function(){this.getJsonData(this.schedule_url,this.displaySchedule)},Sports.prototype.loadLocalSchedule=function(){this.loadData(function(){this.writeScheduleToDOM(),this.getDataSchedule()},this.getDataSchedule)},Sports.prototype.displaySchedule=function(t){this.dataOutOfDate(t)?(this.data=t,this.saveData(this.writeScheduleToDOM())):this.updateEachGame(t)},Sports.prototype.writeScheduleToDOM=function(){this.writeToTemplate(),this.cacheGames(),this.highlightGames()},Sports.prototype.writeToTemplate=function(){},Sports.prototype.dataOutOfDate=function(t){},Sports.prototype.cacheScheduleActions=function(){},Sports.prototype.updateEachGame=function(t){},Sports.prototype.formatScheduleGames=function(){},Sports.prototype.highlightGames=function(){},Sports.prototype.resetSchedule=function(){this.data=null,this.saveData(this.getDataSchedule)},Sports.prototype.updateSchedule=function(){this.getDataSchedule()},Sports.prototype.cacheGames=function(t){},NBA.prototype=Object.create(Sports.prototype),NBA.prototype.constructor=NBA,NBA.prototype.off=function(){console.log("nba off"),this.turnOffAutoUpdate()},NBA.prototype.yyyymmdd=function(t){function e(t){return 10>t?"0"+t:""+t}return t?this.today.setDate(this.today.getDate()+t):this.today=new Date,this.today.getFullYear()+e(this.today.getMonth()+1)+e(this.today.getDate())},NBA.prototype.cacheButtonActions=function(){var t=this;$("body").on("click","#NBA_game_table #remove-game-btn",{that:t},this.removeGame),$("body").on("click","#NBA_col #reset_games",this.resetSchedule.bind(this)),$("body").on("click","#NBA_col #update-btn",this.updateSchedule.bind(this)),$("body").on("click","#NBA_col #autoupdate-btn",{that:t},this.autoupdateSchedule),$("body").on("click","#NBA_col #standings-btn",this.standings.bind(this)),$("body").on("click","#NBA_col #tomorrow-btn",this.tomorrowSchedule.bind(this)),$("body").on("click","#NBA_col #yesterday-btn",this.yesterdaySchedule.bind(this)),$("body").on("click","#NBA_col #today-btn",this.todaySchedule.bind(this))},NBA.prototype.removeGame=function(t){var e=t.data.that,s=$(this).closest("tr").attr("id");for($("#"+s).remove(),$("#c"+s).remove(),i=0;i<e.data.sports_content.games.game.length;i++)if(s==e.data.sports_content.games.game[i].id){e.data.sports_content.games.game[i].hidden=!0;break}e.saveData()},NBA.prototype.dataOutOfDate=function(t){return null==this.data||null==this.data.sports_content?!0:t.sports_content.games.game[0]?!(t.sports_content.games.game[0].date===this.yyyymmdd()):!0},NBA.prototype.massageData=function(t,e){for(i=0;i<t.sports_content.games.game.length;i++){var s=parseInt(t.sports_content.games.game[i].home.score),o=parseInt(t.sports_content.games.game[i].visitor.score);t.sports_content.games.game[i].home.winning=s>o,t.sports_content.games.game[i].visitor.winning=o>s;var a=t.sports_content.games.game[i];if(this.data&&this.data.sports_content&&this.data.sports_content.games.game[i]&&t.sports_content.games.game[i].id==this.data.sports_content.games.game[i].id){var n,r=this.data.sports_content.games.game[i];n=""===a.home.score?!0:parseInt(a.home.score)+parseInt(a.visitor.score)==parseInt(r.home.score)+parseInt(r.visitor.score),t.sports_content.games.game[i].highlight=!n}try{if("1"===t.sports_content.games.game[i].period_time.game_status){var c=parseInt(t.sports_content.games.game[i].time.substring(0,2)),d=parseInt(t.sports_content.games.game[i].time.substring(2,4)),p=parseInt(t.sports_content.games.game[i].date.substring(0,4)),h=parseInt(t.sports_content.games.game[i].date.substring(4,6)),l=parseInt(t.sports_content.games.game[i].date.substring(6,8)),g=new Date(p,h,l);c-=1;var m=5;g.setUTCHours((c+m)%24,d);var u=g.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});t.sports_content.games.game[i].period_time.period_status=u}}catch(y){console.log(y)}("Final"===t.sports_content.games.game[i].period_time.period_status||"Halftime"===t.sports_content.games.game[i].period_time.period_status||t.sports_content.games.game[i].period_time.period_status.includes("Start")||t.sports_content.games.game[i].period_time.period_status.includes("End"))&&(t.sports_content.games.game[i].period_time.game_clock="");var f=parseInt(t.sports_content.games.game[i].period_time.period_value),_=parseInt(t.sports_content.games.game[i].period_time.game_status);f>4&&3==_&&(t.sports_content.games.game[i].overtime=f-4);var v=t.sports_content.games.game[i],b=parseInt(v.period_time.period_value),k=v.period_time.game_clock;if(dev_env&&("GSW"!==v.visitor.abbreviation&&"GSW"!==v.home.abbreviation||(t.sports_content.games.game[i].fav_team=!0)),2==_&&b>3){var N=parseFloat(k.split(":")[0]);if(6>N||k.split(":").length<2){var w=parseInt(a.home.score)-parseInt(a.visitor.score);Math.abs(w)<6&&(t.sports_content.games.game[i].close_game=!0)}}}e.call(this,t)},NBA.prototype.writeToTemplate=function(){this.displayTemplate("NBAschedule","games",this.data.sports_content.games.game,$("#NBA_col"));var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#NBA_col #today").html(t[this.today.getDay()]+" "+this.today.getDate()+", "+e[this.today.getMonth()])},NBA.prototype.updateEachGame=function(t){for(console.log("NBA updating"),i=0;i<this.data.sports_content.games.game.length;i++){if(this.data.sports_content.games.game[i].id!==t.sports_content.games.game[i].id){console.log("data not same -- error");break}this.data.sports_content.games.game[i].hidden&&!this.data.sports_content.games.game[i].close_game&&(t.sports_content.games.game[i].hidden=!0)}this.data=t,this.saveData(this.writeScheduleToDOM())},NBA.prototype.autoupdateSchedule=function(t){$(this).find("span").toggleClass("glyphicon-ok").toggleClass("glyphicon-remove"),$(this).toggleClass("btn-default").toggleClass("btn-success");var e=t.data.that;$(this).hasClass("btn-success")?(console.log("updating---"),e.continueAutoUpdate.bind(e),e.updateGamesID=window.setInterval(e.continueAutoUpdate.bind(e),1e4)):(console.log("clearing---"),window.clearInterval(e.updateGamesID))},NBA.prototype.continueAutoUpdate=function(){var t=!0;for(i=0;i<this.data.sports_content.games.game.length;i++)if("Final"!==this.data.sports_content.games.game[i].period_time.period_status){t=!1;break}t?this.turnOffAutoUpdate():this.getDataSchedule()},NBA.prototype.turnOffAutoUpdate=function(){if(console.log("clearing---"),window.clearInterval(this.updateGamesID),$(this.autoUpdateButtonId).hasClass("btn-success")){var t=$(this.autoUpdateButtonId);t.find("span").toggleClass("glyphicon-remove",!0),t.find("span").toggleClass("glyphicon-ok",!1),t.toggleClass("btn-success",!1),t.toggleClass("btn-default",!0)}},NBA.prototype.highlightGames=function(){for(i=0;i<this.data.sports_content.games.game.length;i++)if(this.data.sports_content.games.game[i].highlight){var t="#"+this.data.sports_content.games.game[i].id;$(t).effect("highlight",{color:"#FFFF99"},2e3),0==this.data.sports_content.games.game[i].highlight}},NBA.prototype.standings=function(){var t="http://data.nba.com/json/cms/2015/standings/conference.json";this.getData(t,this.showStandings)},NBA.prototype.showStandings=function(t){this.displayTemplate("NBAstandings","teams",t.sports_content.standings.conferences.West.team,$("#NBA-standings #West")),this.displayTemplate("NBAstandings","teams",t.sports_content.standings.conferences.East.team,$("#NBA-standings #East"));var e="border-bottom:3pt solid grey;";$($("#NBA-standings #West tr")[8]).attr("style",e),$($("#NBA-standings #East tr")[8]).attr("style",e)},NBA.prototype.tomorrowSchedule=function(t){this.schedule_url="http://data.nba.com/json/cms/noseason/scoreboard/"+this.yyyymmdd(1)+"/games.json",this.resetSchedule()},NBA.prototype.todaySchedule=function(t){this.schedule_url="http://data.nba.com/json/cms/noseason/scoreboard/"+this.yyyymmdd(0)+"/games.json",this.resetSchedule()},NBA.prototype.yesterdaySchedule=function(t){this.schedule_url="http://data.nba.com/json/cms/noseason/scoreboard/"+this.yyyymmdd(-1)+"/games.json",this.resetSchedule()},NFL.prototype=Object.create(Base.prototype),NFL.prototype.constructor=NFL,NFL.prototype.init=function(){NFLnews=new NFLnews,NFLnews.init()},NFLnews.prototype=Object.create(Base.prototype),NFLnews.prototype.constructor=NFL,NFLnews.prototype.init=function(){this.getData(this.rNFLURL,this.displayrNFL),this.dates()},NFLnews.prototype.displayrNFL=function(t){for(var e=t.data.children,s=[],o=0,a=0;5>a&&o<e.length;){var i=e[o].data.link_flair_text;i?this.ignoreFlairs.indexOf(i)<0&&(s.push(e[o]),a++):(s.push(e[o]),a++),o++}for(;o<e.length;){var i=e[o].data.link_flair_text;i&&this.importantFlairs.indexOf(i)>-1&&s.push(e[o]),o++}this.displayTemplate("rNFL","posts",s,$("#rNFL"),!1)},NFLnews.prototype.dates=function(){var t=new Date(2016,3,28),e=[{countdown:countdown(new Date,t,countdown.MONTHS|countdown.DAYS,2).toString(),message:"to the NFL Draft!",date:t.toDateString()}];this.displayTemplate("NFLdates","dates",e,$("#NFL-dates"))},Links.prototype=Object.create(Base.prototype),Links.prototype.constructor=Links,Links.prototype.init=function(){var t=this;$("#bookmark-panel").on("click","#remove_customLink",function(e){e.preventDefault(),t.removeCustomLink($(this).closest("a"))}),$("body").on("click","#addBookmark",{that:this},this.addBookmark),$("body").on("hidden.bs.modal","#addCustomLinkModal",function(){$("#addCustomLinkModal .modal-body").find("textarea,input").val("")})},Links.prototype.addBookmark=function(t){var e=t.data.that;e.data.push({title:$("#bookmark_name").val(),url:$("#bookmark_url").val()}),e.saveData(e.showTopSites())},Links.prototype.showTopSites=function(){chrome.topSites.get(function(t){var e="links",s={};s.topSites=t.slice(0,5),this.data&&this.data.length>0&&(s.customSites=this.data);var o=$("#bookmark-panel");this.displayTemplate("Links",e,s,o),this.saveData()}.bind(this))},Links.prototype.setDefaults=function(){this.data=[{title:"r/NBA",url:"https://www.reddit.com/r/nba"},{title:"r/NFL",url:"https://www.reddit.com/r/nfl"}],this.showTopSites()},Links.prototype.removeCustomLink=function(t){this.data.splice(parseInt(t.attr("id").split("_")[0]),1),0==this.data.length?($("#custom-sites").remove(),this.saveData()):this.saveData(this.showTopSites)};var this_extensionId=chrome.i18n.getMessage("@@extension_id"),chrome_store_extension_id="cbdhcjkifbkbckpoejnakoekiheijpei",dev_env=this_extensionId!==chrome_store_extension_id;if($(document).ready(function(){var t=new pageHandeler;t.init(),navigator.onLine||$("#no-internet-alert").show()}),window.addEventListener("offline",function(t){$("#no-internet-alert").fadeIn()}),window.addEventListener("online",function(t){document.location.reload()}),pageHandeler.prototype=Object.create(Base.prototype),pageHandeler.prototype.constructor=pageHandeler,pageHandeler.prototype.init=function(){this.loadData(this.loadWidgets,this.setDefaults);var t=this;$("#page_options button").on("click",{that:t},triggerWidget)},pageHandeler.prototype.loadWidgets=function(){for(var t=0;t<this.widgetKeys.length;t++)key=this.widgetKeys[t],key in this.data&&1==this.data[key]&&key in this?this[key].on():$("#page_options #"+key+"-button").trigger("click")},pageHandeler.prototype.setDefaults=function(){for(var t=0;t<this.widgetKeys.length;t++)this.data[this.widgetKeys[t]]=!0;this.loadWidgets()},function(t,e,s,o,a,i,n){t.GoogleAnalyticsObject=a,t[a]=t[a]||function(){(t[a].q=t[a].q||[]).push(arguments)},t[a].l=1*new Date,i=e.createElement(s),n=e.getElementsByTagName(s)[0],i.async=1,i.src=o,n.parentNode.insertBefore(i,n)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-72036968-1","auto"),ga("set","checkProtocolTask",function(){}),ga("send","pageview","/new_tab.html"),window.performance){var timeSincePageLoad=Math.round(performance.now());ga("send","timing","JS Dependencies","load",timeSincePageLoad)}$("html").on("click","a",function(t){ga("send","event",description(t,"link"),"click")}),$("html").on("click","button",function(t){ga("send","event",description(t,"button"),"click")}),$("html").on("click","span",function(t){ga("send","event",description(t,"span"),"click")}),$("html").on("click","tr",function(t){ga("send","event","game_row","click")}),window.onerror=function(t,e,s,o,a){var i=o?"\ncolumn: "+o:"";i+=a?"\nerror: "+a:"",error_msg="Error: "+t+"\nurl: "+e+"\nline: "+s+i,ga("send","exception",{exDescription:error_msg})};